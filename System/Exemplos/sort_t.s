.eqv N 500

.data
#vetor: .word 100,99,98,97,96,95,94,93,92,91,90,89,88,87,86,85,84,83,82,81,80,79,78,77,76,75,74,73,72,71,70,69,68,67,66,65,64,63,62,61,60,59,58,57,56,55,54,53,52,51,50,49,48,47,46,45,44,43,42,41,40,39,38,37,36,35,34,33,32,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1
#vetor: .word 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100
#       .word 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100

#vetor: .word 9,2,5,1,8,2,4,3,6,7,10,2,32,54,2,12,6,3,1,78,54,23,1,54,2,65,3,6,55,31
vetor: .word
     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16
    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32
    33    34    35    36    37    38    39    40    41    42    43    44    45    46    47    48
    49    50    51    52    53    54    55    56    57    58    59    60    61    62    63    64
    65    66    67    68    69    70    71    72    73    74    75    76    77    78    79    80
    81    82    83    84    85    86    87    88    89    90    91    92    93    94    95    96
    97    98    99   100   101   102   103   104   105   106   107   108   109   110   111   112
   113   114   115   116   117   118   119   120   121   122   123   124   125   126   127   128
   129   130   131   132   133   134   135   136   137   138   139   140   141   142   143   144
   145   146   147   148   149   150   151   152   153   154   155   156   157   158   159   160
   161   162   163   164   165   166   167   168   169   170   171   172   173   174   175   176
   177   178   179   180   181   182   183   184   185   186   187   188   189   190   191   192
   193   194   195   196   197   198   199   200   201   202   203   204   205   206   207   208
   209   210   211   212   213   214   215   216   217   218   219   220   221   222   223   224
   225   226   227   228   229   230   231   232   233   234   235   236   237   238   239   240
   241   242   243   244   245   246   247   248   249   250   251   252   253   254   255   256
   257   258   259   260   261   262   263   264   265   266   267   268   269   270   271   272
   273   274   275   276   277   278   279   280   281   282   283   284   285   286   287   288
   289   290   291   292   293   294   295   296   297   298   299   300   301   302   303   304
   305   306   307   308   309   310   311   312   313   314   315   316   317   318   319   320
   321   322   323   324   325   326   327   328   329   330   331   332   333   334   335   336
   337   338   339   340   341   342   343   344   345   346   347   348   349   350   351   352
   353   354   355   356   357   358   359   360   361   362   363   364   365   366   367   368
   369   370   371   372   373   374   375   376   377   378   379   380   381   382   383   384
   385   386   387   388   389   390   391   392   393   394   395   396   397   398   399   400
   401   402   403   404   405   406   407   408   409   410   411   412   413   414   415   416
   417   418   419   420   421   422   423   424   425   426   427   428   429   430   431   432
   433   434   435   436   437   438   439   440   441   442   443   444   445   446   447   448
   449   450   451   452   453   454   455   456   457   458   459   460   461   462   463   464
   465   466   467   468   469   470   471   472   473   474   475   476   477   478   479   480
   481   482   483   484   485   486   487   488   489   490   491   492   493   494   495   496
   497   498   499   500


FREQ:	.string "\nFrequencia = "
CPI:	.string "\nCPI = "
TEXEC:  .string "\nTempo Execução = "

.text	
MAIN:	la a0,vetor
	li a1,N
	jal show

	la a0,vetor
	li a1,N
	
	rdcycle s0
	rdinstret s1
	rdtime s2
	jal sort
	rdtime s5
	rdinstret s4
	rdcycle s3
	
	la a0,vetor
	li a1,N
	jal show

	sub s0,s3,s0
	fcvt.s.w ft0,s0		# ciclos
	sub s1,s4,s1
	fcvt.s.w ft1,s1		# instruções
	sub s2,s5,s2
	fcvt.s.w ft2,s2	 	# tempo

	la a0,FREQ
	li a7,4
	ecall
	fdiv.s fa0,ft0,ft2	# clock em kHz
	li a7,2
	ecall

	la a0,CPI
	li a7,4
	ecall
	fdiv.s fa0,ft0,ft1	#CPI
	li a7,2
	ecall


	la a0,TEXEC
	li a7,4
	ecall
	fmv.s fa0,ft2		# texec em ms
	li a7,2
	ecall	


	li a7,10
	ecall


swap:	slli t1,a1,2
	add t1,a0,t1
	lw t0,0(t1)
	lw t2,4(t1)
	sw t2,0(t1)
	sw t0,4(t1)
	ret

sort:	addi sp,sp,-20
	sw ra,16(sp)
	sw s3,12(sp)
	sw s2,8(sp)
	sw s1,4(sp)
	sw s0,0(sp)
	mv s2,a0
	mv s3,a1
	mv s0,zero
for1:	bge s0,s3,exit1
	addi s1,s0,-1
for2:	blt s1,zero,exit2
	slli t1,s1,2
	add t2,s2,t1
	lw t3,0(t2)
	lw t4,4(t2)
#	bge t4,t3,exit2
	bge t3,t4,exit2
	mv a0,s2
	mv a1,s1
	jal swap
	addi s1,s1,-1
	j for2
exit2:	addi s0,s0,1
	j for1
exit1: 	lw s0,0(sp)
	lw s1,4(sp)
	lw s2,8(sp)
	lw s3,12(sp)
	lw ra,16(sp)
	addi sp,sp,20
	ret

show:	mv t0,a0
	mv t1,a1
	mv t2,zero

loop1: 	beq t2,t1,fim1
	li a7,1
	lw a0,0(t0)
	ecall
	li a7,11
	li a0,9
	ecall
	addi t0,t0,4
	addi t2,t2,1
	j loop1

fim1:	li a7,11
	li a0,10
	ecall
	ret
