.data
NUM: .word 1548
NOTAS: 0,50,0,38,0,45,0,86,0,38,0,86,0,86,0,86,0,86,0,38,0,86,0,86,0,86,0,86,0,86,0,86,0,86,0,38,1,50,0,45,1,50,0,38,0,45,0,94,0,38,0,94,0,94,0,94,0,94,0,38,0,94,0,94,0,94,0,94,0,94,0,94,0,94,0,38,1,50,0,45,1,50,0,38,0,45,0,89,0,38,0,89,0,89,0,89,0,89,0,38,0,89,0,89,0,89,0,89,0,89,0,89,0,89,0,38,1,50,0,45,1,50,0,38,0,45,0,38,0,38,1,38,3,50,0,45,1,50,0,38,0,45,0,86,0,38,0,86,0,86,0,86,0,86,0,38,0,86,0,86,0,86,0,86,0,86,0,86,0,86,0,38,1,50,0,45,1,50,0,38,0,45,0,96,0,38,0,96,0,96,0,96,0,96,0,38,0,96,0,96,0,96,0,96,0,96,0,96,0,96,0,38,1,50,0,45,1,50,0,38,0,45,0,94,0,38,0,94,0,94,0,94,0,94,0,38,0,94,0,94,0,94,0,94,0,94,0,94,0,94,0,38,1,50,0,45,1,50,0,38,0,45,0,38,0,38,1,38,3,50,0,45,1,62,0,93,0,38,0,38,0,93,0,93,0,93,0,93,0,93,0,81,0,38,0,38,0,81,0,81,0,81,0,81,0,81,0,91,0,38,0,38,0,91,0,91,0,91,0,91,0,91,0,79,0,79,0,79,0,38,0,79,0,79,0,38,0,38,0,62,0,72,0,79,0,90,0,38,0,38,0,38,0,90,0,90,0,90,0,90,0,90,0,78,0,78,0,78,0,78,0,78,0,78,0,88,0,88,0,88,0,88,0,88,0,88,0,76,0,38,0,38,0,76,0,76,0,38,0,76,0,76,0,38,0,72,0,71,0,76,0,91,0,38,0,38,0,91,0,91,0,91,0,91,0,91,0,79,0,38,0,38,0,79,0,79,0,79,0,79,0,79,0,90,0,38,0,38,0,90,0,90,0,90,0,90,0,90,0,78,0,78,0,78,0,38,0,78,0,78,0,38,0,38,0,71,0,70,0,78,0,88,0,38,0,38,0,38,0,88,0,88,0,88,0,88,0,88,0,76,0,76,0,76,0,76,0,76,0,76,0,86,0,86,0,86,0,86,0,86,0,86,0,74,0,38,0,38,0,74,0,74,0,38,0,74,0,74,0,38,0,70,0,66,0,74,0,93,0,38,0,38,0,93,0,93,0,93,0,93,0,93,0,81,0,38,0,38,0,81,0,81,0,81,0,81,0,81,0,91,0,38,0,38,0,91,0,91,0,91,0,91,0,91,0,79,0,79,0,79,0,38,0,79,0,79,0,38,0,38,0,66,0,72,0,79,0,90,0,38,0,38,0,38,0,90,0,90,0,90,0,90,0,90,0,78,0,78,0,78,0,78,0,78,0,78,0,88,0,88,0,88,0,88,0,88,0,88,0,76,0,38,0,38,0,76,0,76,0,38,0,76,0,76,0,38,0,72,0,70,0,76,0,91,0,38,0,38,0,91,0,91,0,91,0,91,0,91,0,79,0,38,0,38,0,79,0,79,0,79,0,79,0,79,0,90,0,38,0,38,0,90,0,90,0,90,0,90,0,90,0,78,0,78,0,78,0,38,0,78,0,78,0,38,0,38,0,70,0,67,0,78,0,88,0,38,0,38,0,38,0,88,0,88,0,88,0,88,0,88,0,76,0,76,0,76,0,76,0,76,0,76,0,86,0,86,0,86,0,86,0,86,0,86,0,74,0,38,0,38,0,74,0,74,0,38,0,74,0,74,0,38,0,67,0,50,0,54,0,74,0,93,0,40,0,40,0,93,0,93,0,93,0,93,0,54,0,55,0,93,0,81,0,40,0,40,0,81,0,81,0,81,0,81,0,55,0,57,0,81,0,91,0,40,0,40,0,91,0,91,0,91,0,91,0,57,0,59,0,91,0,79,0,79,0,79,0,40,0,79,0,79,0,40,0,40,0,59,0,50,0,60,0,62,0,79,0,90,0,40,0,40,0,40,0,90,0,90,0,90,0,90,0,62,0,64,0,90,0,78,0,78,0,78,0,78,0,78,0,64,0,66,0,78,0,88,0,88,0,88,0,88,0,88,0,66,0,67,0,88,0,76,0,40,0,40,0,76,0,76,0,40,0,76,0,76,0,40,0,67,0,60,0,69,0,59,0,76,0,91,0,40,0,40,0,91,0,91,0,91,0,91,0,91,0,79,0,40,0,40,0,79,0,79,0,79,0,79,0,79,0,90,0,40,0,40,0,90,0,90,0,90,0,90,0,69,0,67,0,90,0,78,0,78,0,78,0,67,0,66,0,40,0,78,0,78,0,40,0,40,0,66,0,59,0,58,0,67,0,78,0,88,0,40,0,40,0,40,0,88,0,88,0,88,0,88,0,88,0,76,0,76,0,76,0,76,0,76,0,76,0,86,0,86,0,86,0,86,0,86,0,67,0,66,0,86,0,74,0,40,0,40,0,74,0,74,0,40,0,66,0,64,0,74,0,74,0,40,0,64,0,58,0,62,0,54,0,74,0,93,0,40,0,40,0,93,0,93,0,93,0,93,0,93,0,81,0,40,0,40,0,81,0,81,0,81,0,81,0,81,0,91,0,40,0,40,0,91,0,91,0,91,0,91,0,62,0,69,0,91,0,79,0,79,0,79,0,40,0,79,0,79,0,40,0,40,0,69,0,54,0,60,0,74,0,79,0,90,0,40,0,40,0,40,0,90,0,90,0,90,0,90,0,90,0,78,0,78,0,78,0,78,0,78,0,78,0,88,0,88,0,88,0,88,0,88,0,88,0,76,0,40,0,40,0,76,0,76,0,40,0,76,0,76,0,40,0,74,0,60,0,58,0,70,0,76,0,91,0,40,0,40,0,91,0,91,0,91,0,91,0,91,0,79,0,40,0,40,0,79,0,79,0,79,0,79,0,70,0,69,0,79,0,90,0,40,0,40,0,90,0,90,0,90,0,90,0,90,0,78,0,78,0,78,0,40,0,78,0,78,0,40,0,40,0,69,0,58,0,55,0,67,0,78,0,88,0,40,0,40,0,40,0,88,0,88,0,88,0,88,0,88,0,76,0,76,0,76,0,76,0,76,0,67,0,66,0,76,0,86,0,86,0,86,0,86,0,86,0,86,0,74,0,40,0,40,0,74,0,74,0,40,0,74,0,74,0,40,0,66,0,55,0,64,0,50,0,74,0,93,0,40,0,40,0,93,0,93,0,93,0,93,0,93,0,81,0,40,0,40,0,81,0,81,0,81,0,81,0,81,0,91,0,40,0,40,0,91,0,91,0,91,0,91,0,64,0,66,0,91,0,79,0,79,0,79,0,40,0,79,0,79,0,40,0,40,0,66,0,50,0,60,0,69,0,79,0,90,0,40,0,40,0,40,0,90,0,90,0,90,0,90,0,90,0,78,0,78,0,78,0,78,0,78,0,78,0,88,0,88,0,88,0,88,0,88,0,69,0,74,0,88,0,76,0,40,0,40,0,76,0,76,0,40,0,76,0,76,0,40,0,74,0,60,0,59,0,64,0,76,0,91,0,40,0,40,0,91,0,91,0,91,0,91,0,91,0,79,0,40,0,40,0,79,0,79,0,79,0,79,0,79,0,90,0,40,0,40,0,90,0,90,0,90,0,90,0,64,0,66,0,90,0,78,0,78,0,78,0,40,0,78,0,78,0,40,0,40,0,66,0,59,0,62,0,58,0,78,0,88,0,40,0,40,0,40,0,88,0,88,0,88,0,88,0,88,0,76,0,76,0,76,0,76,0,76,0,76,0,86,0,86,0,86,0,86,0,86,0,86,0,74,0,40,0,40,0,74,0,74,0,40,0,74,0,74,0,40,0,58,0,62,0,54,0,57,0,74,0,93,0,40,0,40,0,93,0,93,0,93,0,93,0,93,0,81,0,40,0,40,0,81,0,81,0,81,0,81,0,57,0,59,0,81,0,91,0,40,0,40,0,91,0,91,0,91,0,91,0,91,0,79,0,79,0,79,0,40,0,79,0,79,0,40,0,40,0,59,0,54,0,60,0,62,0,79,0,90,0,40,0,40,0,40,0,90,0,90,0,90,0,90,0,90,0,78,0,78,0,78,0,78,0,78,0,62,0,64,0,78,0,88,0,88,0,88,0,88,0,88,0,88,0,76,0,40,0,40,0,76,0,76,0,40,0,76,0,76,0,40,0,64,0,60,0,62,0,58,0,76,0,91,0,40,0,40,0,91,0,91,0,91,0,91,0,91,0,79,0,40,0,40,0,79,0,79,0,79,0,79,0,79,0,90,0,40,0,40,0,90,0,90,0,90,0,90,0,62,0,90,0,78,0,58,0,78,0,78,0,40,0,78,0,78,0,40,0,40,0,58,0,55,0,78,0,88,0,40,0,40,0,58,0,55,0,40,0,88,0,88,0,88,0,88,0,88,0,76,0,76,0,76,0,76,0,76,0,76,0,86,0,86,0,86,0,86,0,86,0,86,0,74,0,40,0,40,0,74,0,74,0,40,0,74,0,74,0,40,0,55,0,54,0,50,0,74,0,81,0,40,0,55,0,40,0,81,0,81,0,40,0,81,0,81,0,40,0,50,0,54,0,54,0,57,0,81,0,69,0,40,0,40,0,57,0,54,0,66,0,62,0,69,0,79,0,49,0,79,0,79,0,49,0,40,0,79,0,79,0,40,0,79,0,69,0,40,0,40,0,62,0,66,0,50,0,69,0,69,0,78,0,40,0,40,0,78,0,78,0,40,0,78,0,78,0,40,0,50,0,57,0,78,0,69,0,40,0,40,0,57,0,69,0,74,0,62,0,69,0,76,0,49,0,76,0,76,0,49,0,40,0,76,0,76,0,40,0,76,0,69,0,40,0,40,0,62,0,74,0,46,0,62,0,69,0,81,0,40,0,40,0,81,0,81,0,40,0,81,0,81,0,40,0,46,0,53,0,81,0,69,0,40,0,40,0,53,0,62,0,65,0,60,0,69,0,79,0,49,0,79,0,79,0,49,0,40,0,79,0,79,0,40,0,79,0,69,0,40,0,40,0,60,0,65,0,46,0,72,0,69,0,77,0,40,0,40,0,77,0,77,0,40,0,77,0,77,0,40,0,46,0,53,0,77,0,69,0,40,0,40,0,53,0,72,0,69,0,60,0,69,0,76,0,49,0,76,0,76,0,49,0,40,0,76,0,76,0,40,0,76,0,69,0,40,0,40,0,60,0,69,0,63,0,39,0,69,0,81,0,40,0,40,0,81,0,81,0,40,0,81,0,81,0,40,0,39,0,46,0,81,0,70,0,40,0,40,0,46,0,63,0,67,0,51,0,70,0,79,0,49,0,79,0,79,0,49,0,40,0,79,0,79,0,40,0,79,0,70,0,40,0,40,0,51,0,67,0,74,0,39,0,70,0,77,0,40,0,40,0,77,0,77,0,40,0,77,0,77,0,40,0,39,0,46,0,77,0,70,0,40,0,40,0,46,0,74,0,70,0,51,0,70,0,79,0,49,0,79,0,79,0,49,0,40,0,79,0,79,0,40,0,79,0,70,0,40,0,40,0,51,0,70,0,69,0,40,0,70,0,81,0,40,0,40,0,81,0,76,0,40,0,40,0,40,0,47,0,76,0,71,0,40,0,40,0,47,0,69,0,64,0,52,0,71,0,81,0,49,0,81,0,76,0,49,0,40,0,40,0,76,0,71,0,40,0,40,0,52,0,64,0,59,0,40,0,71,0,81,0,40,0,40,0,81,0,76,0,40,0,40,0,40,0,47,0,76,0,71,0,40,0,40,0,47,0,59,0,64,0,52,0,71,0,81,0,49,0,81,0,76,0,49,0,40,0,40,0,76,0,71,0,40,0,40,0,52,0,64,0,68,0,40,0,71,0,80,0,40,0,40,0,80,0,76,0,40,0,40,0,40,0,47,0,76,0,71,0,40,0,40,0,47,0,68,0,64,0,52,0,71,0,80,0,49,0,80,0,76,0,49,0,40,0,40,0,76,0,71,0,40,0,40,0,52,0,64,0,59,0,40,0,71,0,80,0,40,0,40,0,80,0,76,0,40,0,40,0,40,0,47,0,76,0,71,0,40,0,40,0,47,0,59,0,64,0,52,0,71,0,80,0,49,0,80,0,76,0,49,0,40,0,40,0,76,0,71,0,40,0,40,0,52,0,64,0,50,0,38,0,45,0,71,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,38,1,50,0,45,1,50,0,38,0,45,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,38,1,50,0,45,1,50,0,38,0,45,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,38,1,50,0,45,1,50,0,38,0,45,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,38,1,50,0,45,1,50,0,38,0,45,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,38,1,50,0,45,1,50,0,38,0,45,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,38,1,50,0,45,1,50,0,38,0,45,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,38,1,50,0,45,1,50,0,38,0,45,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,50,0,38,0,50,0,50,0,50,0,50,0,50,0,38,1,50,0,45,1
LEN: 32
INTRO: 76,789,77,789,71,526,77,789,79,789,83,131,81,131,79,131,76,920,77,789,71,1841,59,131,59,131,60,131,64,131,60,131,76,920,77,789,71,526,77,789,79,789,83,131,81,131,79,131,76,920,77,789,71,1578,64,131,64,394,64,131,64,262,64,131
METKRAID: 0,40,0,64,0,64,0,40,0,52,0,64,0,59,0,64,0,59,0,52,0,40,0,59,0,69,0,59,0,69,0,40,0,52,0,69,0,60,0,69,0,60,0,52,0,40,0,60,0,66,0,60,0,66,0,40,0,52,0,66,0,62,0,66,0,62,0,52,0,40,0,62,0,59,0,62,0,59,0,40,0,52,0,59,0,58,0,59,0,58,0,52,0,40,0,58,0,64,0,58,0,64,0,40,0,52,0,64,0,59,0,64,0,59,0,52,0,40,0,59,0,69,0,59,0,69,0,40,0,52,0,69,0,60,0,69,0,60,0,52,0,40,0,60,0,66,0,60,0,66,0,40,0,52,0,66,0,62,0,66,0,62,0,52,0,40,0,62,0,59,0,62,0,59,0,40,0,52,0,59,0,58,0,59,0,58,0,52,0,40,0,58,0,64,0,58,0,64,0,40,0,52,0,64,0,59,0,64,0,59,0,52,0,40,0,59,0,69,0,59,0,69,0,40,0,52,0,69,0,60,0,69,0,60,0,52,0,40,0,60,0,66,0,60,0,66,0,40,0,52,0,66,0,62,0,66,0,62,0,52,0,40,0,62,0,59,0,62,0,59,0,40,0,52,0,59,0,58,0,59,0,58,0,52,0,40,0,58,0,64,0,58,0,64,0,40,0,52,0,64,0,59,0,64,0,59,0,52,0,40,0,59,0,69,0,59,0,69,0,40,0,52,0,69,0,60,0,69,0,60,0,52,0,40,0,60,0,66,0,60,0,66,0,40,0,52,0,66,0,62,0,66,0,62,0,52,0,40,0,62,0,59,0,62,0,59,0,40,0,52,0,59,0,58,0,59,0,58,0,52,0,36,0,58,0,67,0,58,0,67,0,36,0,48,0,67,0,62,0,67,0,62,0,48,0,36,0,62,0,64,0,62,0,64,0,36,0,48,0,64,0,59,0,64,0,59,0,48,0,38,0,59,0,66,0,59,0,66,0,38,0,50,0,66,0,62,0,66,0,62,0,50,0,38,0,62,0,69,0,62,0,69,0,38,0,50,0,69,0,64,0,69,0,64,0,50,0,36,0,64,0,67,0,64,0,67,0,36,0,48,0,67,0,62,0,67,0,62,0,48,0,36,0,62,0,64,0,62,0,64,0,36,0,48,0,64,0,59,0,64,0,59,0,48,0,38,0,59,0,66,0,59,0,66,0,38,0,50,0,66,0,62,0,66,0,62,0,50,0,38,0,62,0,69,0,62,0,69,0,38,0,50,0,69,0,64,0,69,0,64,0,50,0,40,0,64,0,67,0,64,0,67,0,67,0,64,0,67,0,64,0,40,0,59,0,64,0,67,0,64,0,67,0,67,0,64,0,67,0,64,0,59,0,64,0,64,0,67,0,64,0,67,0,67,0,64,0,67,0,64,0,64,0,42,0,64,0,70,0,64,0,70,0,70,0,66,0,70,0,66,0,42,0,61,0,66,0,70,0,66,0,70,0,70,0,66,0,70,0,66,0,61,0,66,0,66,0,70,0,66,0,70,0,70,0,66,0,70,0,66,0,66,0,41,0,66,0,69,0,66,0,69,0,69,0,65,0,69,0,65,0,41,0,60,0,65,0,69,0,65,0,69,0,69,0,65,0,69,0,65,0,60,0,65,0,65,0,69,0,65,0,69,0,69,0,65,0,69,0,65,0,65,0,47,0,65,0,69,0,65,0,69,0,69,0,63,0,69,0,63,0,47,0,54,0,63,0,66,0,63,0,66,0,66,0,63,0,66,0,63,0,54,0,59,0,63,0,71,0,63,0,71,0,71,0,66,0,71,0,66,0,59,0,40,0,66,0,67,0,66,0,67,0,67,0,64,0,67,0,64,0,40,0,59,0,64,0,67,0,64,0,67,0,67,0,64,0,67,0,64,0,59,0,64,0,64,0,67,0,64,0,67,0,67,0,64,0,67,0,64,0,64,0,42,0,64,0,70,0,64,0,70,0,70,0,66,0,70,0,66,0,42,0,61,0,66,0,70,0,66,0,70,0,70,0,66,0,70,0,66,0,61,0,66,0,66,0,70,0,66,0,70,0,70,0,66,0,70,0,66,0,66,0,41,0,66,0,69,0,66,0,69,0,69,0,65,0,69,0,65,0,41,0,60,0,65,0,69,0,65,0,69,0,69,0,65,0,69,0,65,0,60,0,65,0,65,0
LENMET: 976 
MUSIC_NOTAS: .word 72,667,72,166,67,166,74,166,76,1167,76,166,77,166,79,833,81,333,79,166,77,333,76,333,74,333,72,166,74,166,76,333,76,166,77,166,79,2334,72,166,74,166,76,166,77,166,76,1667,72,667,72,166,67,166,72,166,79,1167,79,166,81,166,83,833,84,333,83,166,81,333,79,333,77,333,74,166,72,166,76,333,76,166,77,166,79,2334,84,166,86,166,88,2001,89,2334,88,166,86,166,84,2001,83,166,84,166,86,166,83,166,84,333,79,2668,74,166,76,166,77,333,76,1667,79,2334,81,166,83,166,84,2001,86,166,88,166,89,166,86,166,87,333,84,1667,77,166,79,166,83,166,79,166,84,333,79,2334,0,0
MUSIC_STATUS: .word 0, 0

.text

MUSIC.SETUP:		# guarda endereco da proxima nota nos status
			la		t0, MUSIC_NOTAS
			la		t1, MUSIC_STATUS
			sw		t0, 4(t1)
			sw		zero, 0(t1)
		
			ret

###################### PROCEDIMENTO MUSIC ######################
#	ARGUMENTOS:						#
#		a0 = endereco status				#
#		a1 = instrumento				#
#		a2 = volume					#
#################################################################
MUSIC.PLAY:		la		a0, MUSIC_STATUS
			li		a2, 0
			li		a3, 50

			lw		t0, 0(a0)
			beqz		t0, MUSIC.PLAY.NOTE

			csrr		t1, 3073		# current time
			bltu		t1, t0, MUSIC.RET	# if (now < next note) do nothing ELSE play note

MUSIC.PLAY.NOTE:	lw		t0, 4(a0)		# t0 = current note address
			lw		t1, 0(t0)		# nota
			lw		t2, 4(t0)		# duracao

			beqz		t1, MUSIC.LAST.PLAYED	# nota == 0, só espera

			mv		t3, a0		# salva a0

			mv		a0, t1		# a0 = nota
			mv		a1, t2		# a1 = duracao
			li		a7, 31		# define a chamada de syscall
			ecall				# toca a nota

			mv		a0, t3		# restaura a0

MUSIC.LAST.PLAYED:	beqz		t2, MUSIC.SETUP	# nota == 0 e duracao == 0, recomeca

			csrr		t3, 3073	# current time
			add		t3, t3, t2	# current time + note duration = next note time
			sw		t3, 0(a0)	# save next note time

			addi		t0, t0, 8	# incrementa endereço da proxima nota
			sw		t0, 4(a0)	# salva proxima nota

MUSIC.RET:		ret

			# dash = pitch 22 inst 118 vol 50
SFX.DASH:		li a0, 22		# pitch
			li a1, 1000		# duracao
			li a2, 118		# instrumento
			li a3, 70		# volume
			li a7, 31		# define a chamada de syscall
			ecall
			
			ret

			# morango = pitch 102 inst 117 vol 50
SFX.MORANGO:		li a0, 102		# pitch
			li a1, 1000		# duracao
			li a2, 117		# instrumento
			li a3, 90		# volume
			li a7, 31		# define a chamada de syscall
			ecall
			
			ret

			# morango = pitch 102 inst 116 vol 50
SFX.REFILL:		li a0, 102		# pitch
			li a1, 1000		# duracao
			li a2, 116		# instrumento
			li a3, 90		# volume
			li a7, 31		# define a chamada de syscall
			ecall
			
			ret
